---
title: "Oscillations - Teaching material"
author: "Johanna Daas"
date: "4 12 2020"
output: html_document
toc_float: True
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Introduction
Why are oscillations so fascinating for science? You will find an answer to that question (hopefully), as well as learn how to code with CoRK. 

This is a teaching document. Whenever there is some code chunk, you can run it. But (as you will quickly see), it will not be completed. Some of the code will need to be put in by you to get to the next result. but don't worry: We will guide you through everything. Don't be shy to be creative with your coding - it is all learning by doing. 

If you need help, click on the "Hint" tab. There we will give you some pointers on where to look, as well as some extra code guide you in the right direction. But it is always a good idea to use google as well if you don't know how a certain function works. You can also use the intrinsic help-function of **R**: ?function gives you the documentation for that function. If you forgot the specific name, you can also use ??function for fuzzy search.

If you are completely lost, you can take a look at the "Solution" tab. Here we will give you the completed code with explanations on why it is working. Of course you can use the Solution tab to check if your result is correct. But don't worry, if your code does not look like ours. If it achieves the same result, it is probably also true. But it can't hurt to take a look at where your solution is different from ours and to try and understand, why we did what we did.

We assume that you already know how to work with **CoRC** a bit or have gone through our [examples](http://www.google.com) LINK!. Also it would help, if you have already some experience with ggplot, but that is not necessary.



## Getting used to our system {.tabset .tabset-pills}
### Code
This is an example on how our tabs work. You can click on the others to get help or take a look at our solution.

### Hint
You successfully clicked on our "Hint" tab. I don't think that you need help navigating these tabs.

### Solution
This is our Solution tab. If you clicked on it and this message is showing, everything is working as it should. Now, on with the coding!

## {-}

<!-- Setup -->

# Setup {.tabset .tabset-pills}
To set up our work with **CoRC**, we first need to install it and tell **R** that we will be using it. For this, we will call the library() function. 

## Code
```{r}
# Your code here
```
It is good practice to set up all libraries at the beginning of your document and not at the point where you first need it. This avoids confusion. So we will also need to tell CoRC about the other package which we will be using: **ggplot2**.

## Hint
You need to call the library() function with the package you want to call as an *argument*.

You also need to make sure to have the package installed before calling it with the library function.
If you are unsure if you have the required packages installed, you can check by using find.package(). If you have the package installed, it will tell you where it is installed.
```{r}
find.package("CoRC")
```

## Solution
You first need to install the packages **CoRC** and **ggplot**. 
```{r}
# #Install CoRC. 
# install.packages("remotes")
# remotes::install_github("jpahle/CoRC")
# CoRC::getCopasi()
# 
# #Install ggplot
# install.packages("ggplot2")
```
Now, we want to call both of these packages with the library function:
```{r}
library(CoRC)
library(ggplot2)
```
And done! We set up our worksheet :)

# {-}

<!-- Load model -->
#  Loading the model {.tabset .tabset-pills}
This implementation is an example from the Condor-Copasi paper LINK!
You can find the model here:
```{r}
loadModel("https://raw.githubusercontent.com/copasi/condor-copasi/master/examples/stochastic_test.cps")
```

## Code
Make yourself familiar with the model and take a look at the species and the reactions.
```{r}
```

## Hint
To inspect an element with **CoRC** you use the *get* family of functions.

## Solution
We want to look at the species and the reactions.
To look at the species we type:
```{r}
getSpecies()
```
and to look at the reactions
```{r}
getReactions()
```

# {-}


# Visualizing species {.tabset .tabset-pills}
We want to show how species "a" behaves over time. For this, we first have to run a Time course. 

```{r}
timecourse <- runTimeCourse()$result

timecourse

```
## Code
Fill in the missing code!
```{r}
# ggplot(data = ) +
#   geom_line(aes(x = , y =))
```
(You have to get rid of the # to uncomment and run the code. If you mark several lines with your pointer and press ctrl+shift+c you can comment/uncomment several lines at once.)

## Hint
You have to think about what is missing here. 

There are some equal signs that only have one side filled out. 

data, x, and y are part of what we want to plot. 

## Solution
*data* is the datatable ggplot draws its data from. We have created a timecourse table that we want to plot, so this is our *data*.

*x* is the x-axis of our plot (the time) and *y* the y-axis (concentration of a). We find both in our datatable that we provided with *data*.

```{r}
ggplot(data = timecourse)+
  geom_line(aes(x = Time, y = a))
```

#  {.tabset .tabset-pills}
Now, can you do the same for b and c?

## Code
```{r}
#Your code here
```

## Hint
Take a look at the code for visualizing a and think about what is the same and what is different for b and c.

## Solution
What we have to change about the code form above is the part telling ggplot what we want to have on our y axis. In the last plot, we wanted a there and now we want b or c.

For b this will look like this:
```{r}
ggplot(data = timecourse) +
  geom_line(aes(x = Time, y = b))
```

Of course, we can put all species in one plot. To see which species are which, we will also color the lines. We can tell ggplot implicitly to color "a" different than "b" by calling the color "a" or "b". Of course you can also explicitly tell which color to use by saying "color = 'red'" (after the aes()command) for example.

```{r}
ggplot(data = timecourse) +
  geom_line(aes(x = Time, y = a, color = "a")) +
  geom_line(aes(x = Time, y = b, color = "b")) +
  geom_line(aes(x = Time, y = c, color = "c"))
```

# {-}







###################
# Name {.tabset .tabset-pills}
## Code
## Hint
## Solution
# {-}